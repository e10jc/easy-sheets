import EasySheets from '../src/index'

const testSheetId = '1rvu6YO89UaZsH1EXOzI_riD1b6JFbOWg6LYFa6JqsNU'
const testCreds64 = 'eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwicHJvamVjdF9pZCI6ImVhc3ktc2hlZXRzLTI0NjExOCIsInByaXZhdGVfa2V5X2lkIjoiZTBmYmRmYTZmZTQ1OWFmMzQ2OWYyNGNkMmFiM2UzMThiZjE2ZDc5YyIsInByaXZhdGVfa2V5IjoiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdlFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLY3dnZ1NqQWdFQUFvSUJBUURxSTJQYmFPQWptblV1XG5ueCtyS0tvYTFob2c2cHFXVXgwd2lKcjd2bU5OR21YTHVhaStzaTgwTWpvaUFxdk1FYzdhY3BoRExEOHkrOC9wXG5OdHFLd3o4VVllbytrVkhrR29VbGIrY1hIa0xNN1RhVEUxVDY4c290RlJCV0F1dC9pR2E2ekhxYTU2QnNlVzVtXG4vK0dRNFBlVytSdlNVdGZZeGpzbS9kK3phb0x0ZXN3anZIc0owUEdOVlRLR2I2aUY3V3llYy9kYmNFblBSMi9OXG50ZWJwSS9lRHZxWXBBamNGcnZ2cU5BUm1zNU5UL1lpdWFiVjJ4RHdFVWxKZVpVMGpmOXhnalVRUG42QlNNSjhqXG5EWjVaSm54b2pmcTE3NkRyM0NnS1h0eFJsQzVCZ2lsYnVsa2JZN0pXY2hJcUlIVTZvMnBmTHU1ZmNRVGExVnplXG5QaTcweUdhTkFnTUJBQUVDZ2dFQUY0SCtJS1ZpKzdBaVc4LzJLZ1VuTHhLWUJQNEpEMWJBODRLRHJRcnNoVzFGXG5Fek5NMGZpcDdKK3VYb1BPSStzVnpiRDd3S0xNcFozS3ZpdVh2WjdrMG5NU1JiM3BidkdLdEx1TGhES3hta21tXG4xUlYzenNwWnFqVVhNc3VRUVhtOGRyelpBbnlIQ3QwV1RKa2NXS045dUZiQ2lGZHcvSDdLcVp1THZrUFBhWEJkXG5xcC9vQXQrbzRwYytWZ0J2NEFUU2xyQ0VVWDZlYjliMGlSVWZEa2lDYk9aYXNTNC85ZEJXWnh3WUQvbEhZckcxXG5xSVIzNHdHOVhsMUpwSmpVcEhjTnBWMGxyQmNFU2VOZUE4MWxHN3k0NXNNdGZ4c2JoSTJQTVRzZ2Y3VVRSMFJYXG5YNWU1NlJDR3JudXpxaW9XSnlaZFR2cG0vNy96bDZLaXRKejQ5L3YwQVFLQmdRRDV2Z2txL3RTZ0pwVU9UeWhtXG5iMnNNUkx5L05IdUZhSm02RWxucmhMak5nOFRhNHZocVcvdktobGFLMmE3K1RjNFVoeFdXbUIxMmlNeVdHTVI4XG4yZnE3WE1ER3QyZzhGVHRzQnlBZEpHQVFnWHJ0alExbXZzWGEwUXZmb0pWZ3YvajBGTVF0RVhkOGJ6cHFGbmtGXG5lZ0JKVkw5Z0FBYlZiL0NmWE5vUnRkbkt6UUtCZ1FEd0FVTXBWeGtlSFNMRlBNWGN3bklYRWluendXQW1XUlhPXG5vVTVJSXpxODJuQzB1ZkRhK2swWWd3eFpmV2RGcUUxUjFIUlJuNCtScCsxaFVKVElUTXpLQVZzVDhJdHB6aXJrXG50UlYyNUJkU0Z0aitjVG1WMmZGRjlPcFhUelBvNGVHbnFhbGtNQngycmxKKzYyOW1YZk81Vi9LRGpRMmRkWXQ2XG5KbDAwalZTS3dRS0JnUUNnOXRyeDIwMHY2NjRtaXQ1L0oxRFhsM1lQeHNQV09KVGNXUGViMU85SGhxWmFiZSt1XG5uWnFyN2VuWmxIUTFjL0JmU3JHZlhtdWUrb3ppTVJSelpBczJ0NUdJZ3Eyc0RBTkFuVmNWY1Z4NVJ2cjBJUFdDXG5RM05DbFhvUnFHNmU3UnlJTk5vOE1nWFJMZDk0Z1FOL2hDS3JJUFEzNjh4N3hLcFNESWFBNDdSOEFRS0JnQjRkXG5HbTh5ZFgxWXpJY1E5QWFhQXpTdjI4R3c3cjZCQ1FKdkxPSlNRVWwyNHhOYURVVjhpSFhkNDR2SzkwMC9LOHhyXG5xdGllKzZXYisyWHRkVzJZYlUyZlUrMHhqbHlOT01hUGpnem4yNkU2S3FucVRQNW5aU1dROEdKYUZycE90VUNUXG5RaVRIQUp0SGppUk1xQ0toQVRhdE9VbVdSaklPa0p5WCtiUGhVODFCQW9HQUtubEVEaFBETFVtTnFwalpCWEw0XG5JMFBlMEJvWVlDSkFYdXBOdFdoL3RZcjY1bmFITnFqekE3Q09jR0lYcjRQTjduT2hndEgzMDM4MUNoMXNPMS9qXG5vR0VQUVdWVmdjNFZHYlV6TXhNUjVra25VeUVXV1RZS0dET0d3ZyswQTJTYUFBdy9rNTZRK01tc3VtcWpCUFJQXG5INjlhVXhlSkZGVmttY2tUdklWY2dDbz1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsImNsaWVudF9lbWFpbCI6InRlc3QtNDkwQGVhc3ktc2hlZXRzLTI0NjExOC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImNsaWVudF9pZCI6IjExODM4MDIxNjQyMTA5MTQ1NDEyNSIsImF1dGhfdXJpIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLCJ0b2tlbl91cmkiOiJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6Imh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsImNsaWVudF94NTA5X2NlcnRfdXJsIjoiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS90ZXN0LTQ5MCU0MGVhc3ktc2hlZXRzLTI0NjExOC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSJ9'

test('clearRange, updateValues, addRow, and getValues', async () => {
  const easySheets = new EasySheets(testSheetId, testCreds64)
  await easySheets.authorize()

  expect(await easySheets.clearRange('A1:A5000000')).toBe(true)
  expect(await easySheets.updateRange('A1:A2', [['1'], ['2']])).toBe(true)
  expect(await easySheets.addRow(['3'])).toBe(true)
  expect(await easySheets.getRange('A1:A3')).toStrictEqual([['1'], ['2'], ['3']])
})